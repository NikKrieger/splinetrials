<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Facilitate Clinical Trials Analysis Using Natural Cubic Splines • splinetrials</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Facilitate Clinical Trials Analysis Using Natural Cubic Splines">
<meta name="description" content="Create mixed models with repeated measures using natural cubic splines applied to an observed continuous time variable, as described by Donohue et al. (2023) &lt;doi:10.1002/pst.2285&gt;. Iterate through multiple covariance structure types until one converges. Categorize observed time according to scheduled visits. Perform subgroup analyses.">
<meta property="og:description" content="Create mixed models with repeated measures using natural cubic splines applied to an observed continuous time variable, as described by Donohue et al. (2023) &lt;doi:10.1002/pst.2285&gt;. Iterate through multiple covariance structure types until one converges. Categorize observed time according to scheduled visits. Perform subgroup analyses.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">splinetrials</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/NikKrieger/splinetrials/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="splinetrials">splinetrials<a class="anchor" aria-label="anchor" href="#splinetrials"></a>
</h1></div>
<!-- badges: start -->

<p>The goal of splinetrials is to analyze longitudinal clinical data applying natural cubic splines to a continuous time variable.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>Install this package from CRAN with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"splinetrials"</span><span class="op">)</span></span></code></pre></div>
<p>You can also install the development version of splinetrials from <a href="https://github.com/NikKrieger/splinetrials" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("pak")</span></span>
<span><span class="fu">pak</span><span class="fu">::</span><span class="fu"><a href="https://pak.r-lib.org/reference/pak.html" class="external-link">pak</a></span><span class="op">(</span><span class="st">"NikKrieger/splinetrials"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h2>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/therneau/survival" class="external-link">survival</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://openpharma.github.io/mmrm/" class="external-link">mmrm</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/NikKrieger/splinetrials" class="external-link">splinetrials</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level1">
<h1 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h1>
<p>The NCS model is a longitudinal mixed model of repeated measures (MMRM) with random effects marginalized out, additive baseline covariates, and time parameterized using natural cubic splines.</p>
</div>
<div class="section level1">
<h1 id="demo">Demo<a class="anchor" aria-label="anchor" href="#demo"></a>
</h1>
<div class="section level2">
<h2 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h2>
<p>The package functions accept data sets with <strong>one row per patient per scheduled visit</strong> (including baseline).</p>
<p>We’ll adapt the <code>pbcseq</code> data set in the survival package:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pbcseq_mod</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">survival</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/survival/man/pbcseq.html" class="external-link">pbcseq</a></span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    years <span class="op">=</span> <span class="va">day</span> <span class="op">/</span> <span class="fl">365.25</span>,</span>
<span>    visit_index <span class="op">=</span></span>
<span>      <span class="fu"><a href="reference/bin_timepoints.html">bin_timepoints</a></span><span class="op">(</span> <span class="co"># splinetrials helper function yielding an ordered factor</span></span>
<span>        observed <span class="op">=</span> <span class="va">years</span>,</span>
<span>        scheduled <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.5</span>, <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">years</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Baseline"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">years</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, <span class="st">"yr"</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="op">)</span>,</span>
<span>    sch_visit_years <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.5</span>, <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">years</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">visit_index</span><span class="op">)</span><span class="op">]</span>,</span>
<span>    sch_visit_label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">visit_index</span><span class="op">)</span>,</span>
<span>    trt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">trt</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"control"</span>, <span class="st">"treatment"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">visit_index</span>, <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">years</span> <span class="op">-</span> <span class="va">sch_visit_years</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">visit_index</span>, .keep_all <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">visit_index</span><span class="op">:</span><span class="va">sch_visit_label</span>, <span class="va">trt</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pbcseq_mod</span></span>
<span><span class="co">#&gt; # A tibble: 1,906 × 23</span></span>
<span><span class="co">#&gt;       id visit_index sch_visit_years sch_visit_label trt     futime status   age</span></span>
<span><span class="co">#&gt;    &lt;int&gt; &lt;ord&gt;                 &lt;dbl&gt; &lt;chr&gt;           &lt;fct&gt;    &lt;int&gt;  &lt;int&gt; &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1     1 Baseline                0   Baseline        treatm…    400      2  58.8</span></span>
<span><span class="co">#&gt;  2     1 0.5 yr                  0.5 0.5 yr          treatm…    400      2  58.8</span></span>
<span><span class="co">#&gt;  3     2 Baseline                0   Baseline        treatm…   5169      0  56.4</span></span>
<span><span class="co">#&gt;  4     2 0.5 yr                  0.5 0.5 yr          treatm…   5169      0  56.4</span></span>
<span><span class="co">#&gt;  5     2 1 yr                    1   1 yr            treatm…   5169      0  56.4</span></span>
<span><span class="co">#&gt;  6     2 2 yr                    2   2 yr            treatm…   5169      0  56.4</span></span>
<span><span class="co">#&gt;  7     2 5 yr                    5   5 yr            treatm…   5169      0  56.4</span></span>
<span><span class="co">#&gt;  8     2 6 yr                    6   6 yr            treatm…   5169      0  56.4</span></span>
<span><span class="co">#&gt;  9     2 7 yr                    7   7 yr            treatm…   5169      0  56.4</span></span>
<span><span class="co">#&gt; 10     2 8 yr                    8   8 yr            treatm…   5169      0  56.4</span></span>
<span><span class="co">#&gt; # ℹ 1,896 more rows</span></span>
<span><span class="co">#&gt; # ℹ 15 more variables: sex &lt;fct&gt;, day &lt;int&gt;, ascites &lt;int&gt;, hepato &lt;int&gt;,</span></span>
<span><span class="co">#&gt; #   spiders &lt;int&gt;, edema &lt;dbl&gt;, bili &lt;dbl&gt;, chol &lt;int&gt;, albumin &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   alk.phos &lt;int&gt;, ast &lt;dbl&gt;, platelet &lt;int&gt;, protime &lt;dbl&gt;, stage &lt;int&gt;,</span></span>
<span><span class="co">#&gt; #   years &lt;dbl&gt;</span></span></code></pre></div>
<p>Notice how the helper function <code><a href="reference/bin_timepoints.html">splinetrials::bin_timepoints()</a></code> creates the visit index, categorizing follow-up visits based on when they were scheduled (see <code><a href="https://rdrr.io/pkg/survival/man/pbcseq.html" class="external-link">?survival::pbcseq</a></code>).</p>
</div>
<div class="section level2">
<h2 id="basic-ncs-analysis">Basic NCS analysis<a class="anchor" aria-label="anchor" href="#basic-ncs-analysis"></a>
</h2>
<p>Once we have these variables created, we are ready for a full NCS analysis using <code><a href="reference/ncs_analysis_subgroup.html">ncs_analysis()</a></code>. This produces a table of summary statistics, including LS means and confidence intervals:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pbc_spline_analysis</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="reference/ncs_analysis_subgroup.html">ncs_analysis</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">pbcseq_mod</span>,</span>
<span>    response <span class="op">=</span> <span class="va">alk.phos</span>,</span>
<span>    subject <span class="op">=</span> <span class="va">id</span>,</span>
<span>    arm <span class="op">=</span> <span class="va">trt</span>,</span>
<span>    control_group <span class="op">=</span> <span class="st">"control"</span>,</span>
<span>    time_observed_continuous <span class="op">=</span> <span class="va">years</span>,</span>
<span>    time_observed_index <span class="op">=</span> <span class="va">visit_index</span>,</span>
<span>    time_scheduled_continuous <span class="op">=</span> <span class="va">sch_visit_years</span>,</span>
<span>    time_scheduled_label <span class="op">=</span> <span class="va">sch_visit_label</span>,</span>
<span>    covariates <span class="op">=</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">bili</span> <span class="op">+</span> <span class="va">albumin</span> <span class="op">+</span> <span class="va">ast</span> <span class="op">+</span> <span class="va">protime</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; → The covariance structure `"us"` did not successfully converge.</span></span>
<span><span class="co">#&gt; Warning in mmrm::mmrm(method = "Satterthwaite", formula = alk.phos ~</span></span>
<span><span class="co">#&gt; spline_fn(years)[, : Divergence with optimizer L-BFGS-B due to problems:</span></span>
<span><span class="co">#&gt; L-BFGS-B needs finite values of 'fn'</span></span>
<span><span class="co">#&gt; mmrm() registered as emmeans extension</span></span>
<span><span class="va">pbc_spline_analysis</span></span>
<span><span class="co">#&gt; # A tibble: 32 × 32</span></span>
<span><span class="co">#&gt;    arm     time         n   est    sd    se lower upper response_est response_se</span></span>
<span><span class="co">#&gt;    &lt;fct&gt;   &lt;chr&gt;    &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 control Baseline   154 1943. 2102. 169.  1611. 2275.        1424.        77.0</span></span>
<span><span class="co">#&gt;  2 control 0.5 yr     131 1574. 1134.  99.1 1379. 1768.        1377.        71.9</span></span>
<span><span class="co">#&gt;  3 control 1 yr       130 1543.  934.  81.9 1382. 1703.        1330.        68.6</span></span>
<span><span class="co">#&gt;  4 control 2 yr       111 1481. 1076. 102.  1281. 1681.        1243.        67.2</span></span>
<span><span class="co">#&gt;  5 control 3 yr        83 1252.  662.  72.7 1110. 1395.        1169.        69.1</span></span>
<span><span class="co">#&gt;  6 control 4 yr        75 1182.  716.  82.7 1020. 1344.        1107.        71.0</span></span>
<span><span class="co">#&gt;  7 control 5 yr        61 1250.  902. 115.  1023. 1476.        1058.        71.1</span></span>
<span><span class="co">#&gt;  8 control 6 yr        56 1073.  589.  78.7  919. 1228.        1019.        69.4</span></span>
<span><span class="co">#&gt;  9 control 7 yr        47 1022.  601.  87.6  851. 1194.         989.        66.6</span></span>
<span><span class="co">#&gt; 10 control 8 yr        37 1021.  554.  91.1  842. 1199.         968.        64.4</span></span>
<span><span class="co">#&gt; # ℹ 22 more rows</span></span>
<span><span class="co">#&gt; # ℹ 22 more variables: response_df &lt;dbl&gt;, response_lower &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   response_upper &lt;dbl&gt;, change_est &lt;dbl&gt;, change_se &lt;dbl&gt;, change_df &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   change_lower &lt;dbl&gt;, change_upper &lt;dbl&gt;, change_test_statistic &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   change_p_value &lt;dbl&gt;, diff_est &lt;dbl&gt;, diff_se &lt;dbl&gt;, diff_df &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   diff_lower &lt;dbl&gt;, diff_upper &lt;dbl&gt;, diff_test_statistic &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   diff_p_value &lt;dbl&gt;, percent_slowing_est &lt;dbl&gt;, …</span></span></code></pre></div>
<p>Note that the above warnings are expected, as splinetrials and <code><a href="https://openpharma.github.io/mmrm/latest-tag/reference/mmrm.html" class="external-link">mmrm::mmrm()</a></code> iterate through different covariance structures and optimizers until a converging model is achieved.</p>
<p>We can plot the resulting model against the data by feeding the resulting data set to <code><a href="reference/ncs_plot_means.html">ncs_plot_means()</a></code>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/ncs_plot_means.html">ncs_plot_means</a></span><span class="op">(</span><span class="va">pbc_spline_analysis</span><span class="op">)</span></span>
<span><span class="va">p1</span></span></code></pre></div>
<p><img src="reference/figures/README-plot_means_no_subgroup-1.png" width="100%"></p>
<div class="section level3">
<h3 id="methods">Methods<a class="anchor" aria-label="anchor" href="#methods"></a>
</h3>
<p>The parameterization has additive effects and pairwise interactions for study arm and time point (i.e., spline basis functions). The model is constrained so that all study arms have equal means at baseline: notice that the same line passes through both the control group’s and the treatment group’s modeled mean baseline estimates:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p1</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="va">response_est</span><span class="op">)</span>,</span>
<span>    data <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">pbc_spline_analysis</span>, <span class="va">time</span> <span class="op">==</span> <span class="st">"Baseline"</span><span class="op">)</span>,</span>
<span>    linetype <span class="op">=</span> <span class="fl">3</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-5-1.png" width="100%"></p>
</div>
</div>
<div class="section level2">
<h2 id="ncs-subgroup-analysis">NCS subgroup analysis<a class="anchor" aria-label="anchor" href="#ncs-subgroup-analysis"></a>
</h2>
<p>Run a NCS analysis with subgroups using <code><a href="reference/ncs_analysis_subgroup.html">ncs_analysis_subgroup()</a></code>. The data set should include a categorical variable to indicate subgroup membership. In this case, the <code>sex</code> variable serves as the <code>subgroup</code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">subgroup_analysis_results</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="reference/ncs_analysis_subgroup.html">ncs_analysis_subgroup</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">pbcseq_mod</span>,</span>
<span>    response <span class="op">=</span> <span class="va">alk.phos</span>,</span>
<span>    subject <span class="op">=</span> <span class="va">id</span>,</span>
<span>    arm <span class="op">=</span> <span class="va">trt</span>,</span>
<span>    control_group <span class="op">=</span> <span class="st">"control"</span>,</span>
<span>    subgroup <span class="op">=</span> <span class="va">sex</span>,</span>
<span>    subgroup_comparator <span class="op">=</span> <span class="st">"f"</span>,</span>
<span>    time_observed_continuous <span class="op">=</span> <span class="va">years</span>,</span>
<span>    time_observed_index <span class="op">=</span> <span class="va">visit_index</span>,</span>
<span>    time_scheduled_continuous <span class="op">=</span> <span class="va">sch_visit_years</span>,</span>
<span>    time_scheduled_label <span class="op">=</span> <span class="va">sch_visit_label</span>,</span>
<span>    covariates <span class="op">=</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">bili</span> <span class="op">+</span> <span class="va">albumin</span> <span class="op">+</span> <span class="va">ast</span> <span class="op">+</span> <span class="va">protime</span>,</span>
<span>    cov_structs <span class="op">=</span> <span class="st">"ar1h"</span>,</span>
<span>    return_models <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; mmrm() registered as car::Anova extension</span></span>
<span><span class="co">#&gt; Warning in mmrm::mmrm(formula = alk.phos ~ spline_fn(years)[, 1] +</span></span>
<span><span class="co">#&gt; spline_fn(years)[, : Divergence with optimizer L-BFGS-B due to problems:</span></span>
<span><span class="co">#&gt; L-BFGS-B needs finite values of 'fn'</span></span>
<span><span class="co">#&gt; Warning in mmrm::mmrm(formula = alk.phos ~ spline_fn(years)[, 1] +</span></span>
<span><span class="co">#&gt; spline_fn(years)[, : Divergence with optimizer L-BFGS-B due to problems:</span></span>
<span><span class="co">#&gt; L-BFGS-B needs finite values of 'fn'</span></span></code></pre></div>
<p>This function returns a list of multiple analyses, which are better looked at one at a time:</p>
<div class="section level3">
<h3 id="between-subgroups-and-within-subgroups">Between subgroups and within subgroups<a class="anchor" aria-label="anchor" href="#between-subgroups-and-within-subgroups"></a>
</h3>
<p>The <code>between</code> and <code>within</code> tables contain the same data except for the treatment effect columns. Note also that they are sorted differently.</p>
<div class="section level4">
<h4 id="between">
<code>between</code><a class="anchor" aria-label="anchor" href="#between"></a>
</h4>
<p>The <code>between</code> table calculates treatment effects between the subgroups within each study arm:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">subgroup_analysis_results</span><span class="op">$</span><span class="va">between</span></span>
<span><span class="co">#&gt; # A tibble: 62 × 30</span></span>
<span><span class="co">#&gt;    arm       time     subgroup     n   est    sd    se lower upper response_est</span></span>
<span><span class="co">#&gt;    &lt;fct&gt;     &lt;chr&gt;    &lt;fct&gt;    &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;        &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 control   Baseline f          139 1966. 2066. 175.  1622. 2309.        1429.</span></span>
<span><span class="co">#&gt;  2 control   Baseline m           15 1734. 2478. 640.   480. 2989.        1640.</span></span>
<span><span class="co">#&gt;  3 treatment Baseline f          137 1950. 2151. 184.  1590. 2310.        1429.</span></span>
<span><span class="co">#&gt;  4 treatment Baseline m           21 2486. 2385. 521.  1466. 3506.        1640.</span></span>
<span><span class="co">#&gt;  5 control   0.5 yr   f          119 1619. 1162. 106.  1410. 1827.        1377.</span></span>
<span><span class="co">#&gt;  6 control   0.5 yr   m           12 1134.  714. 206.   730. 1538.        1572.</span></span>
<span><span class="co">#&gt;  7 treatment 0.5 yr   f          108 1348.  818.  78.7 1194. 1502.        1385.</span></span>
<span><span class="co">#&gt;  8 treatment 0.5 yr   m           17 1646.  821. 199.  1256. 2037.        1592.</span></span>
<span><span class="co">#&gt;  9 control   1 yr     f          118 1575.  944.  86.9 1405. 1745.        1325.</span></span>
<span><span class="co">#&gt; 10 control   1 yr     m           12 1229.  796. 230.   778. 1679.        1506.</span></span>
<span><span class="co">#&gt; # ℹ 52 more rows</span></span>
<span><span class="co">#&gt; # ℹ 20 more variables: response_se &lt;dbl&gt;, response_df &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   response_lower &lt;dbl&gt;, response_upper &lt;dbl&gt;, change_est &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   change_se &lt;dbl&gt;, change_df &lt;dbl&gt;, change_lower &lt;dbl&gt;, change_upper &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   change_test_statistic &lt;dbl&gt;, change_p_value &lt;dbl&gt;, diff_subgroup_est &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   diff_subgroup_se &lt;dbl&gt;, diff_subgroup_df &lt;dbl&gt;, diff_subgroup_lower &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   diff_subgroup_upper &lt;dbl&gt;, diff_subgroup_test_statistic &lt;dbl&gt;, …</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="within">
<code>within</code><a class="anchor" aria-label="anchor" href="#within"></a>
</h4>
<p>The <code>within</code> table calculates treatment effects between each study arm within each subgroup:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">subgroup_analysis_results</span><span class="op">$</span><span class="va">within</span></span>
<span><span class="co">#&gt; # A tibble: 62 × 33</span></span>
<span><span class="co">#&gt;    arm     time     subgroup     n   est    sd    se lower upper response_est</span></span>
<span><span class="co">#&gt;    &lt;fct&gt;   &lt;chr&gt;    &lt;fct&gt;    &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;        &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 control Baseline f          139 1966. 2066. 175.  1622. 2309.        1429.</span></span>
<span><span class="co">#&gt;  2 control 0.5 yr   f          119 1619. 1162. 106.  1410. 1827.        1377.</span></span>
<span><span class="co">#&gt;  3 control 1 yr     f          118 1575.  944.  86.9 1405. 1745.        1325.</span></span>
<span><span class="co">#&gt;  4 control 2 yr     f          100 1527. 1109. 111.  1310. 1744.        1230.</span></span>
<span><span class="co">#&gt;  5 control 3 yr     f           74 1271.  685.  79.6 1115. 1427.        1151.</span></span>
<span><span class="co">#&gt;  6 control 4 yr     f           68 1193.  743.  90.2 1016. 1369.        1088.</span></span>
<span><span class="co">#&gt;  7 control 5 yr     f           54 1297.  949. 129.  1044. 1550.        1040.</span></span>
<span><span class="co">#&gt;  8 control 6 yr     f           49 1093.  619.  88.5  920. 1266.        1005.</span></span>
<span><span class="co">#&gt;  9 control 7 yr     f           40 1049.  641. 101.   850. 1247.         981.</span></span>
<span><span class="co">#&gt; 10 control 8 yr     f           31 1088.  575. 103.   885. 1290.         969.</span></span>
<span><span class="co">#&gt; # ℹ 52 more rows</span></span>
<span><span class="co">#&gt; # ℹ 23 more variables: response_se &lt;dbl&gt;, response_df &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   response_lower &lt;dbl&gt;, response_upper &lt;dbl&gt;, change_est &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   change_se &lt;dbl&gt;, change_df &lt;dbl&gt;, change_lower &lt;dbl&gt;, change_upper &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   change_test_statistic &lt;dbl&gt;, change_p_value &lt;dbl&gt;, diff_arm_est &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   diff_arm_se &lt;dbl&gt;, diff_arm_df &lt;dbl&gt;, diff_arm_lower &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   diff_arm_upper &lt;dbl&gt;, diff_arm_test_statistic &lt;dbl&gt;, …</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="plotting-the-means">Plotting the means<a class="anchor" aria-label="anchor" href="#plotting-the-means"></a>
</h4>
<p>We can supply either of the above result entries (i.e., <code>between</code> or <code>within</code>) to <code><a href="reference/ncs_plot_means_subgroup.html">ncs_plot_means_subgroup()</a></code>. This function creates a grid of plots that again depict the actual and modeled mean responses at each timepoint. Each column of plots contains a study arm and each row of plots contains a subgroup.</p>
<p>We again include horizontal lines to demonstrate that the study arms all have the same modeled mean baseline estimate:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/ncs_plot_means_subgroup.html">ncs_plot_means_subgroup</a></span><span class="op">(</span><span class="va">subgroup_analysis_results</span><span class="op">$</span><span class="va">between</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="va">response_est</span><span class="op">)</span>,</span>
<span>    data <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">subgroup_analysis_results</span><span class="op">$</span><span class="va">between</span>, <span class="va">time</span> <span class="op">==</span> <span class="st">"Baseline"</span><span class="op">)</span>,</span>
<span>    linetype <span class="op">=</span> <span class="fl">3</span>,</span>
<span>    lwd <span class="op">=</span> <span class="fl">0.5</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-9-1.png" width="100%"></p>
</div>
</div>
<div class="section level3">
<h3 id="type-iii-anova">Type-III ANOVA<a class="anchor" aria-label="anchor" href="#type-iii-anova"></a>
</h3>
<p><code>type3</code> contains a Type-III ANOVA on the main analysis model’s terms:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">subgroup_analysis_results</span><span class="op">$</span><span class="va">type3</span></span>
<span><span class="co">#&gt; # A tibble: 14 × 6</span></span>
<span><span class="co">#&gt;    effect             chisquare_test_stati…¹    df p_value correlation optimizer</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;                               &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt;    </span></span>
<span><span class="co">#&gt;  1 spline_fn(years)[…              30.2          1 3.84e-8 heterogene… mmrm+tmb </span></span>
<span><span class="co">#&gt;  2 spline_fn(years)[…              13.5          1 2.43e-4 heterogene… mmrm+tmb </span></span>
<span><span class="co">#&gt;  3 sex                              1.26         1 2.62e-1 heterogene… mmrm+tmb </span></span>
<span><span class="co">#&gt;  4 age                             23.5          1 1.24e-6 heterogene… mmrm+tmb </span></span>
<span><span class="co">#&gt;  5 bili                             6.08         1 1.37e-2 heterogene… mmrm+tmb </span></span>
<span><span class="co">#&gt;  6 albumin                          7.16         1 7.45e-3 heterogene… mmrm+tmb </span></span>
<span><span class="co">#&gt;  7 ast                              2.95         1 8.57e-2 heterogene… mmrm+tmb </span></span>
<span><span class="co">#&gt;  8 protime                          1.76         1 1.85e-1 heterogene… mmrm+tmb </span></span>
<span><span class="co">#&gt;  9 spline_fn(years)[…               1.20         1 2.74e-1 heterogene… mmrm+tmb </span></span>
<span><span class="co">#&gt; 10 spline_fn(years)[…               2.70         1 1.01e-1 heterogene… mmrm+tmb </span></span>
<span><span class="co">#&gt; 11 spline_fn(years)[…               0.000212     1 9.88e-1 heterogene… mmrm+tmb </span></span>
<span><span class="co">#&gt; 12 spline_fn(years)[…               1.29         1 2.56e-1 heterogene… mmrm+tmb </span></span>
<span><span class="co">#&gt; 13 spline_fn(years)[…               0.0588       1 8.08e-1 heterogene… mmrm+tmb </span></span>
<span><span class="co">#&gt; 14 spline_fn(years)[…               0.0164       1 8.98e-1 heterogene… mmrm+tmb </span></span>
<span><span class="co">#&gt; # ℹ abbreviated name: ¹​chisquare_test_statistic</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="subgroup-interaction-test">Subgroup interaction test<a class="anchor" aria-label="anchor" href="#subgroup-interaction-test"></a>
</h3>
<p>The optional <code>interaction</code> result contains an ANOVA comparing the original model fit to a reduced version:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">subgroup_analysis_results</span><span class="op">$</span><span class="va">interaction</span></span>
<span><span class="co">#&gt;           model      aic      bic    loglik -2*log(l) test_statistic df</span></span>
<span><span class="co">#&gt; 1 reduced model 29201.78 29314.07 -14570.89  29141.78             NA NA</span></span>
<span><span class="co">#&gt; 2    full model 29205.64 29325.42 -14570.82  29141.64      0.1351363  2</span></span>
<span><span class="co">#&gt;    p_value                          correlation optimizer</span></span>
<span><span class="co">#&gt; 1       NA heterogeneous autoregressive order 1  mmrm+tmb</span></span>
<span><span class="co">#&gt; 2 0.934664 heterogeneous autoregressive order 1  mmrm+tmb</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="return_models--true">
<code>return_models = TRUE</code><a class="anchor" aria-label="anchor" href="#return_models--true"></a>
</h3>
<p>Lastly, the user can optionally obtain the original analysis model object as well as those used for the subgroup interaction test, which are returned as the <code>analysis_model</code>, <code>full</code>, and <code>reduced</code> entries. These are <code>mmrm</code> objects created using <code><a href="https://openpharma.github.io/mmrm/latest-tag/reference/mmrm.html" class="external-link">mmrm::mmrm()</a></code>. Here is <code>analysis_model</code>, for example:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">subgroup_analysis_results</span><span class="op">$</span><span class="va">analysis_model</span></span>
<span><span class="co">#&gt; mmrm fit</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Formula:     alk.phos ~ spline_fn(years)[, 1] + spline_fn(years)[, 2] + sex +  </span></span>
<span><span class="co">#&gt;     age + bili + albumin + ast + protime + spline_fn(years)[,  </span></span>
<span><span class="co">#&gt;     1]:sex + spline_fn(years)[, 2]:sex + spline_fn(years)[, 1]:trt +  </span></span>
<span><span class="co">#&gt;     spline_fn(years)[, 2]:trt + spline_fn(years)[, 1]:sex:trt +  </span></span>
<span><span class="co">#&gt;     spline_fn(years)[, 2]:sex:trt</span></span>
<span><span class="co">#&gt; Data:        dplyr::mutate(pbcseq_mod, sex = factor(sex, c("f", "m"))) (used </span></span>
<span><span class="co">#&gt; 1860 observations from 312 subjects with maximum 16 timepoints)</span></span>
<span><span class="co">#&gt; Covariance:  heterogeneous auto-regressive order one (17 variance parameters)</span></span>
<span><span class="co">#&gt; Inference:   REML</span></span>
<span><span class="co">#&gt; Deviance:    29002.11</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients: </span></span>
<span><span class="co">#&gt;                             (Intercept)                   spline_fn(years)[, 1] </span></span>
<span><span class="co">#&gt;                             2721.322358                             -815.000265 </span></span>
<span><span class="co">#&gt;                   spline_fn(years)[, 2]                                    sexm </span></span>
<span><span class="co">#&gt;                             -217.027228                              210.533944 </span></span>
<span><span class="co">#&gt;                                     age                                    bili </span></span>
<span><span class="co">#&gt;                              -18.112882                               22.507712 </span></span>
<span><span class="co">#&gt;                                 albumin                                     ast </span></span>
<span><span class="co">#&gt;                              -95.578177                                1.296681 </span></span>
<span><span class="co">#&gt;                                 protime              spline_fn(years)[, 1]:sexm </span></span>
<span><span class="co">#&gt;                              -28.763036                             -458.009692 </span></span>
<span><span class="co">#&gt;              spline_fn(years)[, 2]:sexm      spline_fn(years)[, 1]:trttreatment </span></span>
<span><span class="co">#&gt;                             -478.555152                              -53.251556 </span></span>
<span><span class="co">#&gt;      spline_fn(years)[, 2]:trttreatment spline_fn(years)[, 1]:sexm:trttreatment </span></span>
<span><span class="co">#&gt;                             -299.228629                              113.096456 </span></span>
<span><span class="co">#&gt; spline_fn(years)[, 2]:sexm:trttreatment </span></span>
<span><span class="co">#&gt;                              -78.148527 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Inference Optimization:</span></span>
<span><span class="co">#&gt; Converged with code 0 and message: convergence: rel_reduction_of_f &lt;= factr*epsmch</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level1">
<h1 id="appendix-details-of-the-analysis-results-tables">Appendix: details of the analysis results tables<a class="anchor" aria-label="anchor" href="#appendix-details-of-the-analysis-results-tables"></a>
</h1>
<div class="section level2">
<h2 id="basic-ncs-analysis-1">Basic NCS analysis<a class="anchor" aria-label="anchor" href="#basic-ncs-analysis-1"></a>
</h2>
<p>The basic NCS analysis results table <code>pbc_spline_analysis</code> has one row per study arm per timepoint of interest and the following columns:</p>
<ul>
<li>
<code>arm</code>: study arm, i.e. treatment group</li>
<li>
<code>time</code>: discrete visit time labels from the <code>time_scheduled_label</code> column in the data.</li>
<li>
<code>n</code>: number of non-missing observations.</li>
<li>
<code>est</code>: observed mean response in the data.</li>
<li>
<code>sd</code>: observed standard deviation of the response in the data.</li>
<li>
<code>se</code>: observed standard error of the response in the data (just <code>se / sqrt(n)</code>).</li>
<li>
<code>lower</code>: lower bound of an observed 95% confidence interval in the data.</li>
<li>
<code>upper</code>: upper bound of an observed 95% confidence interval in the data.</li>
<li>
<code>response_est</code>: LS mean of the response.</li>
<li>
<code>response_se</code>: standard error of the LS mean of the response.</li>
<li>
<code>response_df</code>: degrees of freedom of the LS mean of the response.</li>
<li>
<code>response_lower</code>: lower 95% confidence bound of the LS mean of the response.</li>
<li>
<code>response_upper</code>: upper 95% confidence bound of the LS mean of the response.</li>
<li>
<code>change_est</code>, <code>change_lower</code>, <code>change_upper</code>, <code>change_se</code>, <code>change_df</code>: like the analogous <code>response_*</code> columns, but for LS mean change from baseline.</li>
<li>
<code>change_test_statistic</code>: test statistic of a two-sided test that the LS mean change from baseline is not equal to 0, at a significance level of 5%.</li>
<li>
<code>change_p_value</code>: same as <code>change_test_statistic</code>, but the p-value instead of the test statistic.</li>
<li>
<code>diff_est</code>, <code>diff_se</code>, <code>diff_df</code>, <code>diff_lower</code>, <code>diff_upper</code>, <code>diff_test_statistic</code>, <code>diff_p_value</code>: same as the analogous <code>change_*</code> columns, but for treatment differences.</li>
<li>
<code>percent_slowing_est</code> LS mean of percent slowing (on the percentage scale).</li>
<li>
<code>percent_slowing_lower</code>, <code>percent_slowing_upper</code>: a conservative approximation to a confidence interval on percent slowing. Assumes uncorrelated changes from baseline.</li>
<li>
<code>correlation</code>: correlation structure of the whole model.</li>
<li>
<code>optimizer</code>: optimization algorithm for the whole model.</li>
</ul>
</div>
<div class="section level2">
<h2 id="subgroup-analysis">Subgroup analysis<a class="anchor" aria-label="anchor" href="#subgroup-analysis"></a>
</h2>
<div class="section level3">
<h3 id="between-and-within-tables">
<code>between</code> and <code>within</code> tables<a class="anchor" aria-label="anchor" href="#between-and-within-tables"></a>
</h3>
<p>The between-subgroup and within-subgroup tables have one row per study arm per timepoint per subgroup and the following columns:</p>
<ul>
<li>
<code>arm</code>: study arm, i.e. treatment group</li>
<li>
<code>time</code>: discrete visit time labels from the <code>time_scheduled_label</code> column in the data.</li>
<li>
<code>subgroup</code>: subgroup level</li>
<li>
<code>n</code>: number of non-missing observations.</li>
<li>
<code>est</code>: observed mean response in the data.</li>
<li>
<code>sd</code>: observed standard deviation of the response in the data.</li>
<li>
<code>se</code>: observed standard error of the response in the data (just <code>se / sqrt(n)</code>).</li>
<li>
<code>lower</code>: lower bound of an observed 95% confidence interval in the data.</li>
<li>
<code>upper</code>: upper bound of an observed 95% confidence interval in the data.</li>
<li>
<code>response_est</code>: LS mean of the response.</li>
<li>
<code>response_se</code>: standard error of the LS mean of the response.</li>
<li>
<code>response_df</code>: degrees of freedom of the LS mean of the response.</li>
<li>
<code>response_lower</code>: lower 95% confidence bound of the LS mean of the response.</li>
<li>
<code>response_upper</code>: upper 95% confidence bound of the LS mean of the response.</li>
<li>
<code>change_est</code>, <code>change_lower</code>, <code>change_upper</code>, <code>change_se</code>, <code>change_df</code>: like the analogous <code>response_*</code> columns, but for LS mean change from baseline.</li>
<li>
<code>change_test_statistic</code>: test statistic of a two-sided test that the LS mean change from baseline is not equal to 0, at a significance level of 5%.</li>
<li>
<code>change_p_value</code>: same as <code>change_test_statistic</code>, but the p-value instead of the test statistic.</li>
<li>
<code>diff_arm_est</code>, <code>diff_arm_se</code>, <code>diff_arm_df</code>, <code>diff_arm_lower</code>, <code>diff_arm_upper</code>, <code>diff_arm_test_statistic</code>, <code>diff_arm_p_value</code>: same as the analogous <code>change_*</code> columns, but for treatment differences.</li>
<li>
<code>diff_subgroup_est</code>, <code>diff_subgroup_se</code>, <code>diff_subgroup_df</code>, <code>diff_subgroup_lower</code>, <code>diff_subgroup_upper</code>, <code>diff_subgroup_test_statistic</code>, <code>diff_subgroup_p_value</code>: same as the analogous <code>*_arm_*</code> columns, but for the subgroup differences.</li>
<li>
<code>percent_slowing_est</code> LS mean of percent slowing (on the percentage scale).</li>
<li>
<code>percent_slowing_lower</code>, <code>percent_slowing_upper</code>: a conservative approximation to a confidence interval on percent slowing. Assumes uncorrelated changes from baseline.</li>
<li>
<code>correlation</code>: correlation structure of the analysis subgroup model.</li>
<li>
<code>optimizer</code>: optimizer of the analysis subgroup model.</li>
</ul>
</div>
<div class="section level3">
<h3 id="type3-column-descriptions">
<code>type3</code> column descriptions<a class="anchor" aria-label="anchor" href="#type3-column-descriptions"></a>
</h3>
<p>The Type-III ANOVA table has one row per effect in the main analysis model and the following columns:</p>
<ul>
<li>
<code>effect</code>: the model effect in the main analysis model</li>
<li>
<code>chisquare_test_statistic</code>: Chi-squared test statistic for the model term’s significance</li>
<li>
<code>df</code>: degrees of freedom</li>
<li>
<code>p_value</code>: p-value for the test of the model term’s significance</li>
<li>
<code>correlation</code>: correlation structure of the analysis subgroup model.</li>
<li>
<code>optimizer</code>: optimizer of the analysis subgroup model.</li>
</ul>
</div>
<div class="section level3">
<h3 id="interaction-column-descriptions">
<code>interaction</code> column descriptions<a class="anchor" aria-label="anchor" href="#interaction-column-descriptions"></a>
</h3>
<p>The subgroup interaction test table will have two rows: the first will represent the reduced model and the second will depict the full model. Likelihood ratio test results will only be in the latter row. The table will contain the following columns:</p>
<ul>
<li>
<code>model</code>: the model, either full or reduced.</li>
<li>
<code>df</code>: degrees of freedom</li>
<li>
<code>aic</code>: Akaike Information Criterion</li>
<li>
<code>bic</code>: Bayesian Information Criterion</li>
<li>
<code>loglik</code>: log likelihood</li>
<li>
<code>test_statistic</code>: test statistic of the likelihood ratio test.</li>
<li>
<code>p_value</code>: p-value of the likelihood ratio test.</li>
<li>
<code>correlation</code>: correlation structures of the full and reduced models of the interaction test.</li>
<li>
<code>optimizer</code>: optimizers of the full and reduced models of the interaction test.</li>
</ul>
</div>
</div>
</div>

  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=splinetrials" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/NikKrieger/splinetrials/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/NikKrieger/splinetrials/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>Apache License (&gt;= 2)</small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing splinetrials</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Nik Krieger <br><small class="roles"> Author, maintainer </small>   </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://app.codecov.io/gh/NikKrieger/splinetrials" class="external-link"><img src="https://codecov.io/gh/NikKrieger/splinetrials/graph/badge.svg" alt="Codecov test coverage"></a></li>
<li><a href="https://github.com/NikKrieger/splinetrials/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/NikKrieger/splinetrials/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Nik Krieger.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
