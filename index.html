<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Facilitate Clinical Trials Analysis Using Natural Cubic Splines • splinetrials</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Facilitate Clinical Trials Analysis Using Natural Cubic Splines">
<meta name="description" content="Contains tools and helper functions that make it easier to run longitudinal models with continuous time. These tools include natural cubic splines for time data, categorization of continuous observed time according to scheduled visits, and trying multiple covariance structure types.">
<meta property="og:description" content="Contains tools and helper functions that make it easier to run longitudinal models with continuous time. These tools include natural cubic splines for time data, categorization of continuous observed time according to scheduled visits, and trying multiple covariance structure types.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">splinetrials</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/NikKrieger/splinetrials/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="splinetrials">splinetrials<a class="anchor" aria-label="anchor" href="#splinetrials"></a>
</h1></div>
<!-- badges: start -->

<p>The goal of splinetrials is to analyze longitudinal clinical data applying natural cubic splines to a continuous time variable.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of splinetrials from <a href="https://github.com/NikKrieger/splinetrials" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("pak")</span></span>
<span><span class="fu">pak</span><span class="fu">::</span><span class="fu"><a href="https://pak.r-lib.org/reference/pak.html" class="external-link">pak</a></span><span class="op">(</span><span class="st">"NikKrieger/splinetrials"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level1">
<h1 id="methods">Methods<a class="anchor" aria-label="anchor" href="#methods"></a>
</h1>
<p>The NCS model is a longitudinal mixed model of repeated measures (MMRM) with random effects marginalized out, additive baseline covariates, and time parameterized using natural cubic splines. The parameterization has additive effects and pairwise interactions for study arm and time point (i.e., spline basis functions). The model is constrained so that all study arms have equal means at baseline.</p>
</div>
<div class="section level1">
<h1 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h1>
<p>We begin with a clinical data set with one row per patient per scheduled visit (including baseline). The following simulated data set represents the general structure (e.g. column names) but not necessarily realistic responses.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/cross_join.html" class="external-link">cross_join</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>        patient <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">paste0</span>, <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span><span class="va">LETTERS</span>, <span class="va">letters</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">50</span><span class="op">]</span>,</span>
<span>        arm <span class="op">=</span></span>
<span>          <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"control"</span>, <span class="st">"active1"</span>, <span class="st">"active2"</span><span class="op">)</span>, <span class="fl">50</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>        categorical1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"level"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span>, <span class="fl">50</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>        categorical2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"level1"</span>, <span class="st">"level2"</span><span class="op">)</span>, <span class="fl">50</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>        continuous1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">50</span><span class="op">)</span>,</span>
<span>        continuous2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">50</span><span class="op">)</span></span>
<span>      <span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>        time_observed_index <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fl">8</span><span class="op">)</span>,</span>
<span>        time_scheduled_index <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fl">8</span><span class="op">)</span>,</span>
<span>        time_scheduled_label <span class="op">=</span></span>
<span>          <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Baseline"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"visit"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">7</span>, <span class="fl">8</span>, <span class="fl">9</span>, <span class="fl">12</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        time_scheduled_continuous <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0</span>, length.out <span class="op">=</span> <span class="fl">8</span><span class="op">)</span> <span class="op">/</span> <span class="fl">4</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    time_observed_continuous <span class="op">=</span></span>
<span>      <span class="va">time_scheduled_continuous</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>, min <span class="op">=</span> <span class="op">-</span><span class="fl">0.1</span>, max <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>,</span>
<span>    response <span class="op">=</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        <span class="fl">10</span> <span class="op">-</span> <span class="op">(</span><span class="fl">1</span> <span class="op">*</span> <span class="op">(</span><span class="va">arm</span> <span class="op">==</span> <span class="st">"active1"</span><span class="op">)</span> <span class="op">+</span> <span class="fl">2</span> <span class="op">*</span> <span class="op">(</span><span class="va">arm</span> <span class="op">==</span> <span class="st">"active2"</span><span class="op">)</span> <span class="op">+</span></span>
<span>                <span class="fl">3</span> <span class="op">*</span> <span class="op">(</span><span class="va">arm</span> <span class="op">==</span> <span class="st">"control"</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="op">(</span><span class="va">time_observed_index</span> <span class="op">/</span> <span class="fl">4</span><span class="op">)</span> <span class="op">-</span></span>
<span>                                                 <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">time_observed_index</span> <span class="op">/</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt;   patient     arm categorical1 categorical2 continuous1 continuous2</span></span>
<span><span class="co">#&gt; 1      Aa control       level3       level2   0.6466744  -0.9106807</span></span>
<span><span class="co">#&gt; 2      Aa control       level3       level2   0.6466744  -0.9106807</span></span>
<span><span class="co">#&gt; 3      Aa control       level3       level2   0.6466744  -0.9106807</span></span>
<span><span class="co">#&gt; 4      Aa control       level3       level2   0.6466744  -0.9106807</span></span>
<span><span class="co">#&gt; 5      Aa control       level3       level2   0.6466744  -0.9106807</span></span>
<span><span class="co">#&gt; 6      Aa control       level3       level2   0.6466744  -0.9106807</span></span>
<span><span class="co">#&gt;   time_observed_index time_scheduled_index time_scheduled_label</span></span>
<span><span class="co">#&gt; 1                   1                    1             Baseline</span></span>
<span><span class="co">#&gt; 2                   2                    2              visit 3</span></span>
<span><span class="co">#&gt; 3                   3                    3              visit 4</span></span>
<span><span class="co">#&gt; 4                   4                    4              visit 5</span></span>
<span><span class="co">#&gt; 5                   5                    5              visit 7</span></span>
<span><span class="co">#&gt; 6                   6                    6              visit 8</span></span>
<span><span class="co">#&gt;   time_scheduled_continuous time_observed_continuous  response</span></span>
<span><span class="co">#&gt; 1                      0.00               0.07296151 10.685015</span></span>
<span><span class="co">#&gt; 2                      0.25               0.18543891 11.766415</span></span>
<span><span class="co">#&gt; 3                      0.50               0.49866375  8.439280</span></span>
<span><span class="co">#&gt; 4                      0.75               0.73594267  7.332906</span></span>
<span><span class="co">#&gt; 5                      1.00               1.01285277  6.027557</span></span>
<span><span class="co">#&gt; 6                      1.25               1.28123246  6.099311</span></span></code></pre></div>
<p>The following is a summary of the required columns in the data set. Here are the columns not related to time points or visits:</p>
<ol style="list-style-type: decimal">
<li>
<code>response</code>: User-supplied numeric vector of responses to the clinical endpoint. Could be <code>AVAL</code>.</li>
<li>
<code>patient</code>: User-supplied character vector, ID of the patient in the study. Usually <code>USUBJID</code>.</li>
<li>
<code>arm</code>: User-supplied character vector, study arm of the given patient.</li>
<li>
<code>categorical1</code>, <code>categorical2</code>: User-supplied example categorical baseline covariates.</li>
<li>
<code>continuous1</code>, <code>continuous2</code>: User-supplied example continuous baseline covariates.</li>
</ol>
<p>Here are the columns related to time points or visits:</p>
<ol style="list-style-type: decimal">
<li>
<code>time_observed_continuous</code>: User-supplied numeric vector of continuous times corresponding to each observed patient visit. Varies from patient to patient. Units could be in years, months, or days, or some other unit. Must be on the same time scale as <code>time_scheduled_continuous</code>. (If the former is in weeks, then the latter must also be in weeks.)</li>
<li>
<code>time_observed_index</code>: User-supplied integer index vector of <em>bins</em> of observed time points. These numeric labels should indicate groupings of time points based on rounding <code>time_observed_continuous</code> to a small set of strategic fixed time points.</li>
<li>
<code>time_observed_factor</code>: Derived ordered factor version of <code>time_observed_index</code> to structure the correlation matrix. Derived as <code>ordered(as.character(time_observed_index), levels = as.character(sort(unique(time_observed_index))))</code>.</li>
<li>
<code>time_scheduled_index</code>: User-supplied integer index vector of scheduled visit numbers. Usually <code>AVISITN</code>.</li>
<li>
<code>time_scheduled_label</code>: User-supplied character vector of human-readable scheduled visit labels. Usually <code>AVISIT</code>.</li>
<li>
<code>time_scheduled_continuous</code>: User-supplied numeric vector of continuous times of when each visit was scheduled. It must be on the same time scale as <code>time_scheduled_continuous</code>, the values must have a one-to-one correspondence with the scheduled visits in <code>time_scheduled_label</code>, and the baseline must have a value of 0. If the time scale is weeks, then the study team can create this variable in advance using <code>time_scheduled_label</code> (e.g. <code>AVISIT</code>). For example, if <code>AVISIT</code> is <code>"Baseline"</code>, then <code>time_scheduled_continuous</code> must be 0. If <code>time_scheduled_label</code> is <code>"Visit Number 5 (Week 24)"</code>, then <code>time_scheduled_continuous</code> should be 24.</li>
</ol>
<div class="section level2">
<h2 id="main-analysis">Main analysis<a class="anchor" aria-label="anchor" href="#main-analysis"></a>
</h2>
<p>The NCS analysis is a call to a single function: <code><a href="reference/ncs_analysis_subgroup.html">ncs_analysis()</a></code>. This produces a table of summary statistics, including LS means and confidence intervals. All arguments to <code><a href="reference/ncs_analysis_subgroup.html">ncs_analysis()</a></code> should be exposed as user inputs.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/NikKrieger/splinetrials" class="external-link">splinetrials</a></span><span class="op">)</span></span>
<span><span class="va">results_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/ncs_analysis_subgroup.html">ncs_analysis</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  response <span class="op">=</span> <span class="st">"response"</span>,</span>
<span>  subject <span class="op">=</span> <span class="st">"patient"</span>,</span>
<span>  arm <span class="op">=</span> <span class="st">"arm"</span>,</span>
<span>  control_group <span class="op">=</span> <span class="st">"control"</span>,</span>
<span>  time_observed_continuous <span class="op">=</span> <span class="st">"time_observed_continuous"</span>,</span>
<span>  time_observed_index <span class="op">=</span> <span class="st">"time_observed_index"</span>,</span>
<span>  time_scheduled_continuous <span class="op">=</span> <span class="st">"time_scheduled_continuous"</span>,</span>
<span>  time_scheduled_label <span class="op">=</span> <span class="st">"time_scheduled_label"</span>,</span>
<span>  covariates <span class="op">=</span> <span class="op">~</span> <span class="va">continuous1</span> <span class="op">+</span> <span class="va">categorical2</span>,</span>
<span>  cov_structs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"us"</span>, <span class="st">"toeph"</span>, <span class="st">"ar1h"</span>, <span class="st">"csh"</span>, <span class="st">"cs"</span><span class="op">)</span>,</span>
<span>  df <span class="op">=</span> <span class="fl">3</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results_table</span></span>
<span><span class="co">#&gt; # A tibble: 24 × 32</span></span>
<span><span class="co">#&gt;    arm     time         n   est    sd    se lower upper response_est response_se</span></span>
<span><span class="co">#&gt;    &lt;fct&gt;   &lt;chr&gt;    &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 active1 Baseline    19 10.0  1.04  0.240  9.57 10.5          9.95       0.127</span></span>
<span><span class="co">#&gt;  2 active1 visit 3     19  9.13 0.909 0.208  8.72  9.54         9.40       0.105</span></span>
<span><span class="co">#&gt;  3 active1 visit 4     19  9.02 1.10  0.253  8.53  9.52         8.94       0.144</span></span>
<span><span class="co">#&gt;  4 active1 visit 5     19  9.08 0.969 0.222  8.65  9.52         8.69       0.138</span></span>
<span><span class="co">#&gt;  5 active1 visit 7     19  8.57 1.17  0.268  8.05  9.10         8.63       0.134</span></span>
<span><span class="co">#&gt;  6 active1 visit 8     19  8.72 0.861 0.198  8.34  9.11         8.70       0.150</span></span>
<span><span class="co">#&gt;  7 active1 visit 9     19  9.16 1.21  0.278  8.61  9.70         8.84       0.126</span></span>
<span><span class="co">#&gt;  8 active1 visit 12    19  8.83 0.851 0.195  8.45  9.21         9.03       0.183</span></span>
<span><span class="co">#&gt;  9 active2 Baseline    13 10.3  0.883 0.245  9.82 10.8          9.95       0.127</span></span>
<span><span class="co">#&gt; 10 active2 visit 3     13  8.49 1.10  0.304  7.90  9.09         9.19       0.120</span></span>
<span><span class="co">#&gt; # ℹ 14 more rows</span></span>
<span><span class="co">#&gt; # ℹ 22 more variables: response_df &lt;dbl&gt;, response_lower &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   response_upper &lt;dbl&gt;, change_est &lt;dbl&gt;, change_se &lt;dbl&gt;, change_df &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   change_lower &lt;dbl&gt;, change_upper &lt;dbl&gt;, change_test_statistic &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   change_p_value &lt;dbl&gt;, diff_est &lt;dbl&gt;, diff_se &lt;dbl&gt;, diff_df &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   diff_lower &lt;dbl&gt;, diff_upper &lt;dbl&gt;, diff_test_statistic &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   diff_p_value &lt;dbl&gt;, percent_slowing_est &lt;dbl&gt;, …</span></span></code></pre></div>
<p>The table has one row per study arm per timepoint of interest and the following columns.</p>
<ul>
<li>
<code>arm</code>: study arm, i.e. treatment group</li>
<li>
<code>time</code>: discrete visit time labels from the <code>time_scheduled_label</code> column in the data.</li>
<li>
<code>n</code>: number of non-missing observations.</li>
<li>
<code>est</code>: observed mean response in the data.</li>
<li>
<code>sd</code>: observed standard deviation of the response in the data.</li>
<li>
<code>se</code>: observed standard error of the response in the data (just <code>se / sqrt(n)</code>).</li>
<li>
<code>lower</code>: lower bound of an observed 95% confidence interval in the data.</li>
<li>
<code>upper</code>: upper bound of an observed 95% confidence interval in the data.</li>
<li>
<code>response_est</code>: LS mean of the response.</li>
<li>
<code>response_se</code>: standard error of the LS mean of the response.</li>
<li>
<code>response_df</code>: degrees of freedom of the LS mean of the response.</li>
<li>
<code>response_lower</code>: lower 95% confidence bound of the LS mean of the response.</li>
<li>
<code>response_upper</code>: upper 95% confidence bound of the LS mean of the response.</li>
<li>
<code>change_est</code>, <code>change_lower</code>, <code>change_upper</code>, <code>change_se</code>, <code>change_df</code>: like the analogous <code>response_*</code> columns, but for LS mean change from baseline.</li>
<li>
<code>change_test_statistic</code>: test statistic of a two-sided test that the LS mean change from baseline is not equal to 0, at a significance level of 5%.</li>
<li>
<code>change_p_value</code>: same as <code>change_test_statistic</code>, but the p-value instead of the test statistic.</li>
<li>
<code>diff_est</code>, <code>diff_se</code>, <code>diff_df</code>, <code>diff_lower</code>, <code>diff_upper</code>, <code>diff_test_statistic</code>, <code>diff_p_value</code>: same as the analogous <code>change_*</code> columns, but for treatment differences.</li>
<li>
<code>percent_slowing_est</code> LS mean of percent slowing (on the percentage scale).</li>
<li>
<code>percent_slowing_lower</code>, <code>percent_slowing_upper</code>: a conservative approximation to a confidence interval on percent slowing. Assumes uncorrelated changes from baseline.</li>
<li>
<code>correlation</code>: correlation structure of the whole model.</li>
<li>
<code>optimizer</code>: optimization algorithm for the whole model.</li>
</ul>
<p>We can plot the model against the data.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/ncs_plot_means.html">ncs_plot_means</a></span><span class="op">(</span><span class="va">results_table</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-plot_means_no_subgroup-1.png" width="100%"></p>
</div>
<div class="section level2">
<h2 id="subgroup-analysis">Subgroup analysis<a class="anchor" aria-label="anchor" href="#subgroup-analysis"></a>
</h2>
<p>The subgroup analysis is similar, but it begins with a data set with a categorical variable column to indicate subgroup membership.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">data_with_subgroup</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/cross_join.html" class="external-link">cross_join</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>        patient <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">paste0</span>, <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span><span class="va">LETTERS</span>, <span class="va">letters</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">120</span><span class="op">]</span>,</span>
<span>        arm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"control"</span>, <span class="st">"active1"</span>, <span class="st">"active2"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">40</span><span class="op">)</span>,</span>
<span>        subgroup <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"subgroup1"</span>, <span class="st">"subgroup2"</span>, <span class="st">"subgroup3"</span><span class="op">)</span>, times <span class="op">=</span> <span class="fl">40</span><span class="op">)</span>,</span>
<span>        categorical1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"level"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span>, <span class="fl">120</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>        categorical2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"level1"</span>, <span class="st">"level2"</span><span class="op">)</span>, <span class="fl">120</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>        continuous1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">120</span><span class="op">)</span>,</span>
<span>        continuous2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">120</span><span class="op">)</span></span>
<span>      <span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>        time_observed_index <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fl">8</span><span class="op">)</span>,</span>
<span>        time_scheduled_index <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fl">8</span><span class="op">)</span>,</span>
<span>        time_scheduled_label <span class="op">=</span></span>
<span>          <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Baseline"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"visit"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">7</span>, <span class="fl">8</span>, <span class="fl">9</span>, <span class="fl">12</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        time_scheduled_continuous <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0</span>, length.out <span class="op">=</span> <span class="fl">8</span><span class="op">)</span> <span class="op">/</span> <span class="fl">4</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    time_observed_continuous <span class="op">=</span></span>
<span>      <span class="va">time_scheduled_continuous</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>, min <span class="op">=</span> <span class="op">-</span><span class="fl">0.1</span>, max <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>,</span>
<span>    response <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      mean <span class="op">=</span></span>
<span>        <span class="fl">10</span> <span class="op">-</span> <span class="op">(</span><span class="fl">1</span> <span class="op">*</span> <span class="op">(</span><span class="va">arm</span> <span class="op">==</span> <span class="st">"active1"</span><span class="op">)</span> <span class="op">+</span> <span class="fl">2</span> <span class="op">*</span> <span class="op">(</span><span class="va">arm</span> <span class="op">==</span> <span class="st">"active2"</span><span class="op">)</span> <span class="op">+</span></span>
<span>                <span class="fl">3</span> <span class="op">*</span> <span class="op">(</span><span class="va">arm</span> <span class="op">==</span> <span class="st">"control"</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="op">(</span><span class="va">time_observed_index</span> <span class="op">/</span> <span class="fl">4</span><span class="op">)</span> <span class="op">-</span></span>
<span>                                                 <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">time_observed_index</span> <span class="op">/</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">data_with_subgroup</span><span class="op">)</span></span>
<span><span class="co">#&gt;   patient     arm  subgroup categorical1 categorical2 continuous1 continuous2</span></span>
<span><span class="co">#&gt; 1      Aa control subgroup1       level1       level1  -0.9568919   0.6060734</span></span>
<span><span class="co">#&gt; 2      Aa control subgroup1       level1       level1  -0.9568919   0.6060734</span></span>
<span><span class="co">#&gt; 3      Aa control subgroup1       level1       level1  -0.9568919   0.6060734</span></span>
<span><span class="co">#&gt; 4      Aa control subgroup1       level1       level1  -0.9568919   0.6060734</span></span>
<span><span class="co">#&gt; 5      Aa control subgroup1       level1       level1  -0.9568919   0.6060734</span></span>
<span><span class="co">#&gt; 6      Aa control subgroup1       level1       level1  -0.9568919   0.6060734</span></span>
<span><span class="co">#&gt;   time_observed_index time_scheduled_index time_scheduled_label</span></span>
<span><span class="co">#&gt; 1                   1                    1             Baseline</span></span>
<span><span class="co">#&gt; 2                   2                    2              visit 3</span></span>
<span><span class="co">#&gt; 3                   3                    3              visit 4</span></span>
<span><span class="co">#&gt; 4                   4                    4              visit 5</span></span>
<span><span class="co">#&gt; 5                   5                    5              visit 7</span></span>
<span><span class="co">#&gt; 6                   6                    6              visit 8</span></span>
<span><span class="co">#&gt;   time_scheduled_continuous time_observed_continuous response</span></span>
<span><span class="co">#&gt; 1                      0.00              -0.07428706 9.336270</span></span>
<span><span class="co">#&gt; 2                      0.25               0.23840196 9.916441</span></span>
<span><span class="co">#&gt; 3                      0.50               0.43845954 6.507177</span></span>
<span><span class="co">#&gt; 4                      0.75               0.73698012 7.510785</span></span>
<span><span class="co">#&gt; 5                      1.00               0.94502668 6.533178</span></span>
<span><span class="co">#&gt; 6                      1.25               1.34221926 9.607641</span></span></code></pre></div>
<p>For completeness, here is a full description of the columns in the data. Columns not related to time points or visits:</p>
<ol style="list-style-type: decimal">
<li>
<code>subgroup</code>: User-supplied character vector indicating the subgroup of each patient.</li>
<li>
<code>response</code>: User-supplied numeric vector of responses to the clinical endpoint. Could be <code>AVAL</code>.</li>
<li>
<code>patient</code>: User-supplied character vector, ID of the patient in the study. Usually <code>USUBJID</code>.</li>
<li>
<code>arm</code>: User-supplied character vector, study arm of the given patient.</li>
<li>
<code>categorical1</code>, <code>categorical2</code>: User-supplied example categorical baseline covariates.</li>
<li>
<code>continuous1</code>, <code>continuous2</code>: User-supplied example continuous baseline covariates.</li>
</ol>
<p>Columns related to time points and visits:</p>
<ol style="list-style-type: decimal">
<li>
<code>time_observed_continuous</code>: User-supplied numeric vector of continuous times corresponding to each observed patient visit. Varies from patient to patient. Units could be in years, months, or days, or some other unit. Must be on the same time scale as <code>time_scheduled_continuous</code>. (If the former is in weeks, then the latter must also be in weeks.)</li>
<li>
<code>time_observed_index</code>: User-supplied integer index vector of <em>bins</em> of observed time points. These numeric labels should indicate groupings of time points based on rounding <code>time_observed_continuous</code> to a small set of strategic fixed time points.</li>
<li>
<code>time_observed_factor</code>: Derived ordered factor version of <code>time_observed_index</code> to structure the correlation matrix. Derived as <code>ordered(as.character(time_observed_index), levels = as.character(sort(unique(time_observed_index))))</code>.</li>
<li>
<code>time_scheduled_index</code>: User-supplied integer index vector of scheduled visit numbers. Usually <code>AVISITN</code>.</li>
<li>
<code>time_scheduled_label</code>: User-supplied character vector of human-readable scheduled visit labels. Usually <code>AVISIT</code>.</li>
<li>
<code>time_scheduled_continuous</code>: User-supplied numeric vector of continuous times of when each visit was scheduled. It must be on the same time scale as <code>time_scheduled_continuous</code>, the values must have a one-to-one correspondence with the scheduled visits in <code>time_scheduled_label</code>, and the baseline must have a value of 0. If the time scale is weeks, then the study team can create this variable in advance using <code>time_scheduled_label</code> (e.g. <code>AVISIT</code>). For example, if <code>AVISIT</code> is <code>"Baseline"</code>, then <code>time_scheduled_continuous</code> must be 0. If <code>time_scheduled_label</code> is <code>"Visit Number 5 (Week 24)"</code>, then <code>time_scheduled_continuous</code> should be 24.</li>
</ol>
<p>The NCS subgroup analysis is a call to a single function: <code><a href="reference/ncs_analysis_subgroup.html">ncs_analysis_subgroup()</a></code>. This produces a table of summary statistics, including LS means and confidence intervals.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">subgroup_results</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="reference/ncs_analysis_subgroup.html">ncs_analysis_subgroup</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">data_with_subgroup</span>,</span>
<span>    response <span class="op">=</span> <span class="st">"response"</span>,</span>
<span>    subject <span class="op">=</span> <span class="st">"patient"</span>,</span>
<span>    arm <span class="op">=</span> <span class="st">"arm"</span>,</span>
<span>    control_group <span class="op">=</span> <span class="st">"control"</span>,</span>
<span>    subgroup <span class="op">=</span> <span class="st">"subgroup"</span>,</span>
<span>    subgroup_comparator <span class="op">=</span> <span class="st">"subgroup1"</span>,</span>
<span>    time_observed_continuous <span class="op">=</span> <span class="st">"time_observed_continuous"</span>,</span>
<span>    time_observed_index <span class="op">=</span> <span class="st">"time_observed_index"</span>,</span>
<span>    time_scheduled_continuous <span class="op">=</span> <span class="st">"time_scheduled_continuous"</span>,</span>
<span>    time_scheduled_label <span class="op">=</span> <span class="st">"time_scheduled_label"</span>,</span>
<span>    covariates <span class="op">=</span> <span class="op">~</span> <span class="va">continuous1</span> <span class="op">+</span> <span class="va">categorical2</span>,</span>
<span>    cov_structs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"us"</span>, <span class="st">"toeph"</span>, <span class="st">"ar1h"</span>, <span class="st">"csh"</span>, <span class="st">"cs"</span><span class="op">)</span>,</span>
<span>    df <span class="op">=</span> <span class="fl">3</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>We can plot the model against the data.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/ncs_plot_means_subgroup.html">ncs_plot_means_subgroup</a></span><span class="op">(</span><span class="va">subgroup_results</span><span class="op">$</span><span class="va">within</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-plot_means_subgroup-1.png" width="100%"></p>
<p>Between-subgroup table:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">subgroup_results</span><span class="op">$</span><span class="va">between</span></span>
<span><span class="co">#&gt; # A tibble: 72 × 30</span></span>
<span><span class="co">#&gt;    arm     time     subgroup      n   est    sd    se lower upper response_est</span></span>
<span><span class="co">#&gt;    &lt;fct&gt;   &lt;chr&gt;    &lt;fct&gt;     &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;        &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 active1 Baseline subgroup1    13 10.2  1.05  0.292  9.60 10.7          9.83</span></span>
<span><span class="co">#&gt;  2 active1 Baseline subgroup2    14  9.72 1.19  0.317  9.10 10.3          9.85</span></span>
<span><span class="co">#&gt;  3 active1 Baseline subgroup3    13  9.81 1.14  0.317  9.18 10.4          9.80</span></span>
<span><span class="co">#&gt;  4 active2 Baseline subgroup1    13 10.3  1.60  0.444  9.39 11.1          9.83</span></span>
<span><span class="co">#&gt;  5 active2 Baseline subgroup2    13 10.1  1.06  0.295  9.53 10.7          9.85</span></span>
<span><span class="co">#&gt;  6 active2 Baseline subgroup3    14  9.92 0.741 0.198  9.53 10.3          9.80</span></span>
<span><span class="co">#&gt;  7 control Baseline subgroup1    14 10.2  1.20  0.320  9.52 10.8          9.83</span></span>
<span><span class="co">#&gt;  8 control Baseline subgroup2    13 10.3  1.45  0.402  9.50 11.1          9.85</span></span>
<span><span class="co">#&gt;  9 control Baseline subgroup3    13  9.88 0.896 0.249  9.39 10.4          9.80</span></span>
<span><span class="co">#&gt; 10 active1 visit 3  subgroup1    13  9.26 1.11  0.307  8.66  9.86         9.59</span></span>
<span><span class="co">#&gt; # ℹ 62 more rows</span></span>
<span><span class="co">#&gt; # ℹ 20 more variables: response_se &lt;dbl&gt;, response_df &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   response_lower &lt;dbl&gt;, response_upper &lt;dbl&gt;, change_est &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   change_se &lt;dbl&gt;, change_df &lt;dbl&gt;, change_lower &lt;dbl&gt;, change_upper &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   change_test_statistic &lt;dbl&gt;, change_p_value &lt;dbl&gt;, diff_subgroup_est &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   diff_subgroup_se &lt;dbl&gt;, diff_subgroup_df &lt;dbl&gt;, diff_subgroup_lower &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   diff_subgroup_upper &lt;dbl&gt;, diff_subgroup_test_statistic &lt;dbl&gt;, …</span></span></code></pre></div>
<p>Within-subgroup table:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">subgroup_results</span><span class="op">$</span><span class="va">within</span></span>
<span><span class="co">#&gt; # A tibble: 72 × 33</span></span>
<span><span class="co">#&gt;    arm     time     subgroup      n   est    sd    se lower upper response_est</span></span>
<span><span class="co">#&gt;    &lt;fct&gt;   &lt;chr&gt;    &lt;fct&gt;     &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;        &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 active1 Baseline subgroup1    13 10.2  1.05  0.292  9.60 10.7          9.83</span></span>
<span><span class="co">#&gt;  2 active1 visit 3  subgroup1    13  9.26 1.11  0.307  8.66  9.86         9.59</span></span>
<span><span class="co">#&gt;  3 active1 visit 4  subgroup1    13  9.25 0.856 0.237  8.78  9.71         9.34</span></span>
<span><span class="co">#&gt;  4 active1 visit 5  subgroup1    13  9.42 1.01  0.280  8.87  9.97         9.07</span></span>
<span><span class="co">#&gt;  5 active1 visit 7  subgroup1    13  8.80 0.762 0.211  8.39  9.22         8.81</span></span>
<span><span class="co">#&gt;  6 active1 visit 8  subgroup1    13  8.82 1.03  0.286  8.26  9.38         8.64</span></span>
<span><span class="co">#&gt;  7 active1 visit 9  subgroup1    13  8.56 0.893 0.248  8.08  9.05         8.63</span></span>
<span><span class="co">#&gt;  8 active1 visit 12 subgroup1    13  8.72 1.15  0.319  8.09  9.34         8.72</span></span>
<span><span class="co">#&gt;  9 active2 Baseline subgroup1    13 10.3  1.60  0.444  9.39 11.1          9.83</span></span>
<span><span class="co">#&gt; 10 active2 visit 3  subgroup1    13  8.95 1.10  0.306  8.35  9.55         9.21</span></span>
<span><span class="co">#&gt; # ℹ 62 more rows</span></span>
<span><span class="co">#&gt; # ℹ 23 more variables: response_se &lt;dbl&gt;, response_df &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   response_lower &lt;dbl&gt;, response_upper &lt;dbl&gt;, change_est &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   change_se &lt;dbl&gt;, change_df &lt;dbl&gt;, change_lower &lt;dbl&gt;, change_upper &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   change_test_statistic &lt;dbl&gt;, change_p_value &lt;dbl&gt;, diff_arm_est &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   diff_arm_se &lt;dbl&gt;, diff_arm_df &lt;dbl&gt;, diff_arm_lower &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   diff_arm_upper &lt;dbl&gt;, diff_arm_test_statistic &lt;dbl&gt;, …</span></span></code></pre></div>
<p>The between-subgroup and within-subgroup tables have one row per study arm per timepoint per subgroup and the following columns.</p>
<ul>
<li>
<code>arm</code>: study arm, i.e. treatment group</li>
<li>
<code>time</code>: discrete visit time labels from the <code>time_scheduled_label</code> column in the data.</li>
<li>
<code>subgroup</code>: subgroup level</li>
<li>
<code>n</code>: number of non-missing observations.</li>
<li>
<code>est</code>: observed mean response in the data.</li>
<li>
<code>sd</code>: observed standard deviation of the response in the data.</li>
<li>
<code>se</code>: observed standard error of the response in the data (just <code>se / sqrt(n)</code>).</li>
<li>
<code>lower</code>: lower bound of an observed 95% confidence interval in the data.</li>
<li>
<code>upper</code>: upper bound of an observed 95% confidence interval in the data.</li>
<li>
<code>response_est</code>: LS mean of the response.</li>
<li>
<code>response_se</code>: standard error of the LS mean of the response.</li>
<li>
<code>response_df</code>: degrees of freedom of the LS mean of the response.</li>
<li>
<code>response_lower</code>: lower 95% confidence bound of the LS mean of the response.</li>
<li>
<code>response_upper</code>: upper 95% confidence bound of the LS mean of the response.</li>
<li>
<code>change_est</code>, <code>change_lower</code>, <code>change_upper</code>, <code>change_se</code>, <code>change_df</code>: like the analogous <code>response_*</code> columns, but for LS mean change from baseline.</li>
<li>
<code>change_test_statistic</code>: test statistic of a two-sided test that the LS mean change from baseline is not equal to 0, at a significance level of 5%.</li>
<li>
<code>change_p_value</code>: same as <code>change_test_statistic</code>, but the p-value instead of the test statistic.</li>
<li>
<code>diff_arm_est</code>, <code>diff_arm_se</code>, <code>diff_arm_df</code>, <code>diff_arm_lower</code>, <code>diff_arm_upper</code>, <code>diff_arm_test_statistic</code>, <code>diff_arm_p_value</code>: same as the analogous <code>change_*</code> columns, but for treatment differences.</li>
<li>
<code>diff_subgroup_est</code>, <code>diff_subgroup_se</code>, <code>diff_subgroup_df</code>, <code>diff_subgroup_lower</code>, <code>diff_subgroup_upper</code>, <code>diff_subgroup_test_statistic</code>, <code>diff_subgroup_p_value</code>: same as the analogous <code>*_arm_*</code> columns, but for the subgroup differences.</li>
<li>
<code>percent_slowing_est</code> LS mean of percent slowing (on the percentage scale).</li>
<li>
<code>percent_slowing_lower</code>, <code>percent_slowing_upper</code>: a conservative approximation to a confidence interval on percent slowing. Assumes uncorrelated changes from baseline.</li>
<li>
<code>correlation</code>: correlation structure of the analysis subgroup model.</li>
<li>
<code>optimizer</code>: optimizer of the analysis subgroup model.</li>
</ul>
<p>Type-III ANOVA fixed effects:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">subgroup_results</span><span class="op">$</span><span class="va">type3</span></span>
<span><span class="co">#&gt; # A tibble: 15 × 6</span></span>
<span><span class="co">#&gt;    effect            chisquare_test_stati…¹    df  p_value correlation optimizer</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;                              &lt;dbl&gt; &lt;int&gt;    &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt;    </span></span>
<span><span class="co">#&gt;  1 spline_fn(time_o…               134.         1 4.36e-31 heterogene… mmrm+tmb </span></span>
<span><span class="co">#&gt;  2 spline_fn(time_o…               342.         1 2.23e-76 heterogene… mmrm+tmb </span></span>
<span><span class="co">#&gt;  3 spline_fn(time_o…               189.         1 6.16e-43 heterogene… mmrm+tmb </span></span>
<span><span class="co">#&gt;  4 subgroup                          0.0641     2 9.68e- 1 heterogene… mmrm+tmb </span></span>
<span><span class="co">#&gt;  5 continuous1                       1.72       1 1.90e- 1 heterogene… mmrm+tmb </span></span>
<span><span class="co">#&gt;  6 categorical2                      0.958      1 3.28e- 1 heterogene… mmrm+tmb </span></span>
<span><span class="co">#&gt;  7 spline_fn(time_o…                 0.770      2 6.80e- 1 heterogene… mmrm+tmb </span></span>
<span><span class="co">#&gt;  8 spline_fn(time_o…                 0.189      2 9.10e- 1 heterogene… mmrm+tmb </span></span>
<span><span class="co">#&gt;  9 spline_fn(time_o…                 0.514      2 7.73e- 1 heterogene… mmrm+tmb </span></span>
<span><span class="co">#&gt; 10 spline_fn(time_o…                24.7        2 4.26e- 6 heterogene… mmrm+tmb </span></span>
<span><span class="co">#&gt; 11 spline_fn(time_o…               376.         2 2.02e-82 heterogene… mmrm+tmb </span></span>
<span><span class="co">#&gt; 12 spline_fn(time_o…                42.0        2 7.62e-10 heterogene… mmrm+tmb </span></span>
<span><span class="co">#&gt; 13 spline_fn(time_o…                13.9        4 7.74e- 3 heterogene… mmrm+tmb </span></span>
<span><span class="co">#&gt; 14 spline_fn(time_o…                 2.62       4 6.23e- 1 heterogene… mmrm+tmb </span></span>
<span><span class="co">#&gt; 15 spline_fn(time_o…                 2.54       4 6.37e- 1 heterogene… mmrm+tmb </span></span>
<span><span class="co">#&gt; # ℹ abbreviated name: ¹​chisquare_test_statistic</span></span></code></pre></div>
<p>There is also a table for the subgroup interaction test:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">subgroup_results</span><span class="op">$</span><span class="va">interaction</span></span>
<span><span class="co">#&gt;           model      aic      bic    loglik -2*log(l) test_statistic df</span></span>
<span><span class="co">#&gt; 1 reduced model 2884.131 3040.231 -1386.066  2772.131             NA NA</span></span>
<span><span class="co">#&gt; 2    full model 2891.246 3080.796 -1377.623  2755.246       16.88529 12</span></span>
<span><span class="co">#&gt;     p_value                correlation optimizer</span></span>
<span><span class="co">#&gt; 1        NA heterogeneous unstructured  mmrm+tmb</span></span>
<span><span class="co">#&gt; 2 0.1539634 heterogeneous unstructured  mmrm+tmb</span></span></code></pre></div>
<p>The test itself is a likelihood ratio test between a full model with subgroup-treatment interaction and a reduced model without subgroup-treatment interaction. The table has a row for the full model, a row for the reduced model, and the following columns.</p>
<ul>
<li>
<code>model</code>: the model, either full or reduced.</li>
<li>
<code>df</code>: degrees of freedom</li>
<li>
<code>aic</code>: Akaike Information Criterion</li>
<li>
<code>bic</code>: Bayesian Information Criterion</li>
<li>
<code>loglik</code>: log likelihood</li>
<li>
<code>test_statistic</code>: test statistic of the likelihood ratio test.</li>
<li>
<code>p_value</code>: p-value of the likelihood ratio test.</li>
<li>
<code>correlation</code>: correlation structures of the full and reduced models of the interaction test.</li>
<li>
<code>optimizer</code>: optimizers of the full and reduced models of the interaction test.</li>
</ul>
</div>
</div>

  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/NikKrieger/splinetrials/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/NikKrieger/splinetrials/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>Apache License (&gt;= 2)</small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing splinetrials</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Nik Krieger <br><small class="roles"> Author, maintainer </small>   </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://app.codecov.io/gh/NikKrieger/splinetrials" class="external-link"><img src="https://codecov.io/gh/NikKrieger/splinetrials/graph/badge.svg" alt="Codecov test coverage"></a></li>
<li><a href="https://github.com/NikKrieger/splinetrials/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/NikKrieger/splinetrials/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Nik Krieger.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
